<!DOCTYPE html>
<html>

<head>
    <title>弹出框</title>
    
<!-- 页面头部引用资源及配置 -->
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no, email=no"/>
<link rel="shortcut icon" href="/favicon.ico">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<!-- build:css --> 
<link rel="stylesheet" href="../assets/css/plugins.css" />
<link rel="stylesheet" href="../assets/css/base.css" />
<!-- endbuild -->
<script type="text/javascript" src="../assets/scripts/plugins/adaptive.js"></script>
<script type="text/javascript">
    window['adaptive'].desinWidth = 750; // 设计图宽度 
    // window['adaptive'].maxWidth = 480;
    window['adaptive'].baseFont = 14; // 没有缩放时的字体大小 
    window['adaptive'].init(); // 调用初始化方法
</script>
<!-- 页面头部引用资源及配置 -->
    <style>
        .popup-test-wrap{
            height: auto;
            margin: 0 auto;
            text-align: center;
            padding:30px;
            font-size:20px;
        }
        .popup-item{
            margin-bottom:10px;
        }
    </style>
</head>
<body>
    
    <!-- wrapper start -->
    <section class="wrapper">
        <!-- page-wrap start -->
        <section class="page-wrap page-popup">
            <!-- header start -->
            <header class="header">
    <div class="header-wrap">
        <a href="#" class="m-arrow-left">
            <i class="icon icon-left"></i>
            返回
        </a>
        <h1 class="m-title">弹出层</h1>
    </div>
</header>
            <!-- header end   -->
    
            <!-- container start -->
            <section class="container">
                <div class="popup-test-wrap">
                    <div class="popup-item">
                        <a href="javascript:;" id="j-popup-test-1">弹出框带input输入内容</a>
                    </div>

                    <div class="popup-item">
                        <a href="javascript:;" id="j-popup-test-2">公共提示信息</a>
                    </div>

                    <div class="popup-item">
                        <a href="javascript:;" id="j-popup-test-3">操作表</a>
                    </div>

                    <div class="popup-item">
                        <a href="javascript:;" id="j-popup-test-4">确认导入订单</a>
                    </div>

                    <div class="popup-item">
                        <p><a href="#" data-popup=".popup-filtrate" class="open-popup">我的账本-筛选 </a></p>
                    </div>
                    <div class="popup-item">
                        <a href="javascript:;" id="j-popup-test-5">订单确认</a>
                    </div>

                    <div class="popup-item">
                        <p><a href="#"  data-popup=".popup-choose" class="open-popup">选规格</a></p>
                    </div>
                </div>
            </section>
            <!-- container end   -->


            <!-- 我的账本-筛选 start -->
            <div class="popup popup-filtrate">
                <div class="popup-filtrate-wrap">
                    <ul class="popup-filtrate-item">
                        <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl close-popup">全部</a></li>
                        <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl close-popup">配餐收入</a></li>
                        <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl close-popup">送餐收入</a></li>
                        <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl close-popup">退款</a></li>
                    </ul>
                </div>
            </div>
            <!-- 我的账本-筛选 end  -->

            <!-- 购物车订单确认 -->
            <div class="popup popup-shopping-cart" id="j-shopping-cart">
                <div class="shopping-cart-hd">
                    <a href="javascript:;" class="shoping-cart-clear">清空</a>
                </div>
                <div class="shopping-cart-cont">
                    <div class="m-shopping-business">
                        <div class="business-hd">
                            <img src="../assets/images/icon/icon-main-big.png" alt="商家图标" class="business-thumb" />
                            <label class="business-name">川坝子川菜馆</label>
                        </div>
                        <div class="goods-list">
                            <div class="goods-item j-goods-item">
                                <div class="goods-info-base">
                                    <img src="../assets/images/icon/icon-meal-1.png" alt="商品缩略图" class="goods-thumb" />
                                    <label class="goods-name">长寿面</label>
                                </div>
                                <div class="goods-info-count">
                                    <span class="m-goods-count">
                                        <a href="javascript:;" class="icon-btn-reduce"></a>
                                        <label class="count-number j-count-number">1</label>
                                        <a href="javascript:;" class="icon-btn-add"></a>
                                    </span>
                                    <label class="goods-price j-goods-price">12.01</label>
                                </div>
                            </div>
                            <div class="goods-item j-goods-item">
                                <div class="goods-info-base">
                                    <img src="../assets/images/icon/icon-meal-1.png" alt="商品缩略图" class="goods-thumb" />
                                    <label class="goods-name">长寿面</label>
                                </div>
                                <div class="goods-info-count">
                                    <span class="m-goods-count">
                                        <a href="javascript:;" class="icon-btn-reduce"></a>
                                        <label class="count-number j-count-number">1</label>
                                        <a href="javascript:;" class="icon-btn-add"></a>
                                    </span>
                                    <label class="goods-price j-goods-price">12.00</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="m-shopping-business">
                        <div class="business-hd">
                            <img src="../assets/images/icon/icon-main-big.png" alt="商家图标" class="business-thumb" />
                            <label class="business-name">川坝子川菜馆</label>
                        </div>
                        <div class="goods-list">
                            <div class="goods-item j-goods-item">
                                <div class="goods-info-base">
                                    <img src="../assets/images/icon/icon-meal-1.png" alt="商品缩略图" class="goods-thumb" />
                                    <label class="goods-name">长寿面</label>
                                </div>
                                <div class="goods-info-count">
                                    <span class="m-goods-count">
                                        <a href="javascript:;" class="icon-btn-reduce"></a>
                                        <label class="count-number j-count-number">1</label>
                                        <a href="javascript:;" class="icon-btn-add"></a>
                                    </span>
                                    <label class="goods-price j-goods-price">12.00</label>
                                </div>
                                <div class="goods-remark">
                                    <label>加个煎蛋 小份</label>
                                    <label class="remark">备注：不要茶叶蛋，要煎蛋</label>
                                </div>
                            </div>
                            <div class="goods-item j-goods-item">
                                <div class="goods-info-base">
                                    <img src="../assets/images/icon/icon-meal-1.png" alt="商品缩略图" class="goods-thumb" />
                                    <label class="goods-name">长寿面</label>
                                </div>
                                <div class="goods-info-count">
                                    <span class="m-goods-count">
                                        <a href="javascript:;" class="icon-btn-reduce"></a>
                                        <label class="count-number j-count-number">1</label>
                                        <a href="javascript:;" class="icon-btn-add"></a>
                                    </span>
                                    <label class="goods-price j-goods-price">12.00</label>
                                </div>
                                <div class="goods-remark">
                                    <label>加个煎蛋 小份</label>
                                    <label class="remark">备注：不要茶叶蛋，要煎蛋</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="shopping-cart-ft">
                    <i class="icon icon-cart"></i>
                    <div class="ft-cont">
                        <div class="price-all" id="j-price-all">0.00</div>
                        <div class="price-remark">未含餐盒费和配送费</div>
                    </div>
                    <a href="javascript:;" class="ui-btn ui-btn-yellow-xxl">提交订单</a>
                </div>
            </div>
            <script type="text/javascript">
                window.onload = function(){
                    var shoppingCart = $('#j-shopping-cart');
                    var goodsItems = shoppingCart.find('.j-goods-item');
                    var priceAll = shoppingCart.find('#j-price-all');


                    var runAllPrice = function(){
                        var i = 0, len = goodsItems.length, item, allPrice = 0;
                        for(;i<len;i++){
                            item = goodsItems.eq(i);
                            var price = parseFloat(item.find('.j-goods-price').html()) || 0;
                            var count = parseInt(item.find('.j-count-number').html()) || 1;
                            allPrice += (price * count);
                        }
                        var returnPrice = parseFloat(allPrice).toFixed(2) || 0;
                        priceAll.html(returnPrice);
                        return returnPrice;
                    };
                    runAllPrice();

                    //加、减数量
                    var runCountNumber = function(target, flag){
                        var countNumber = target.parent().find('.j-count-number');
                        var number = (parseInt(countNumber.html())) + flag;
                        countNumber.html(number || 1);
                        runAllPrice();
                    };

                    //减
                    shoppingCart.on('click', '.icon-btn-reduce', function(){
                        runCountNumber($(this), -1);
                    });
                    //加
                    shoppingCart.on('click', '.icon-btn-add', function(){
                        runCountNumber($(this), 1);
                    });
                    //清空
                    shoppingCart.on('click', '.shoping-cart-clear', function(){
                        shoppingCart.find('.shopping-cart-cont').html('');
                        goodsItems = shoppingCart.find('.j-goods-item');
                        runAllPrice();
                    });
                };
            </script>
            <!-- 购物车订单确认 -->


            <!-- 选规格 start -->
            <div class="popup popup-choose">
                <div class="popup-choose-wrap">
                    <h2>请选择</h2>
                    <div class="popup-choose-type">
                        <ul class="popup-choose-food">
                            <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl active">韭菜猪肉-1</a></li>
                            <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl">韭菜猪肉-2</a></li>
                            <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl">韭菜猪肉-3</a></li>
                        </ul>
                        <ul class="popup-choose-size">
                            <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl active">小份</a></li>
                            <li><a href="javascript:;" class="ui-btn ui-btn-yellow-bd-xxl">大份</a></li>
                        </ul>
                    </div><!--/popup-choose-type-->

                    <div class="popup-choose-input"><input type="text" placeholder="可选填备注(10字以内)"></div>
                    <div class="popup-handle">
                        <div class="food-wrap">
                            <p class="food-price">12.00</p>
                            <p class="food-name fn-nowrap"><span id="j-food-name">韭菜猪肉</span>，<span id="j-food-size">小份</span></p>
                        </div>
                        <div class="popup-add-cart">
                            <a href="javascript:;" class="ui-btn ui-btn-yellow-xxl" id="j-add-cart">加入购物车</a>
                            <span class="m-goods-count hide">
                                <a href="javascript:;" class="icon-btn-reduce"></a>
                                <label class="count-number j-count-number">1</label>
                                <a href="javascript:;" class="icon-btn-add"></a>
                            </span>
                        </div>
                    </div>
                </div><!--/popup-choose-wrap-->
            </div>
            <!-- 选规格 end  -->

            <!-- footer start -->
            <!--用户端 start -->
<footer class="footer">
    <div class="m-toolbar">
        <a class="m-toolbar-item active" href="#">
            <i class="icon icon-main"></i>
            <span>食堂订餐</span>
        </a>
        <a class="m-toolbar-item" href="#">
            <i class="icon icon-note"></i>
            <span>我的订单</span>
        </a>
        <a class="m-toolbar-item" href="#">
            <i class="icon icon-me"></i>
            <span>个人中心</span>
        </a>
    </div>
</footer>
<!--用户端 end -->
            <!-- footer end  -->
    
        </section>
        <!-- page-wrap end   -->
    </section>
    
    <!-- 页面底部部引用资源 -->
<!-- build:scripts -->
<script type="text/javascript" src="../assets/scripts/vendor.js"></script>
<script type="text/javascript" src="../assets/scripts/plugins/sm.js"></script>
<script type="text/javascript" src="../assets/scripts/plugins/sm-extend.js"></script>
<!-- endbuild -->
    <script type="text/javascript">
        $(function(){
            /***
             * 弹出框带input输入内容
             */
            $('#j-popup-test-1').click(function(){
                var modal = $.modal({
                    afterText:'<input type="text" class="modal-text-input" placeholder="请备注取消配餐原因(16个字以内)">' ,
                    buttons: [
                        {
                            text: '取消'
                        },
                        {
                            text: '确定',
                            onClick: function () {

                            }
                        },
                    ]
                })
            });

            /***
             * 公共提示信息
             */
            $('#j-popup-test-2').click(function(){
                $.modal({
                    text:   '<div class="modal-tips">'+
                    '<p>是否清空购物车？</p>'+
                    '</div>',
                    buttons: [
                        {
                            text: '取消',
                            onClick: function() {
                            }
                        },
                        {
                            text: '确定',
                            onClick: function() {
                            }
                        },
                    ]
                })
            });

            /***
             * 操作表
             */
            $('#j-popup-test-3').click(function(){
                var buttons1 = [
                    {
                        text: '我来送餐',
                        onClick: function() {
                        }
                    },
                    {
                        text: '完成配餐，其他人送餐',
                        onClick: function() {
                        }
                    },
                    {
                        text: '完成配餐，其他人送餐',
                        onClick: function() {
                        }
                    }
                ];
                var buttons2 = [
                    {
                        color: 'blue',
                        text: '取消'

                    }
                ];
                var groups = [buttons1, buttons2];
                Zepto.actions(groups);
            });

            /***
             * 确认导入订单
             */
            $('#j-popup-test-4').click(function(){
                $.modal({
                    title:  '是否要配送',
                    text:   '<div class="modal-order-info">'+
                    '<p>订单号：1234567890</p>'+
                    '<p>林晓梅的订单</p>'+
                    '</div>',
                    buttons: [
                        {
                            text: '重新扫描',
                            onClick: function() {
                            }
                        },
                        {
                            text: '确认',
                            onClick: function() {
                            }
                        },
                    ]
                })
            });

            /***
             * 我的账本-筛选
             */
            $(".popup-filtrate-item li a").click(function(){
                $(this).parent().parent().find('a').removeClass('active');
                $(this).addClass('active');
            });



            // <!-- 购物车订单确认 -->
            $('#j-popup-test-5').click(function(){
                $.popup('#j-shopping-cart');
            });

            /***
             * 选规格
             */
            var foodNameActive = $(".popup-choose-food li  a.active");
            var foodSizeActive =  $(".popup-choose-size li a.active");
            $("#j-food-name").html(foodNameActive.text());
            $("#j-food-size").html(foodSizeActive.text());

            $(".popup-choose-food li a").click(function(){
                $(this).parent().parent().find('a').removeClass('active');
                $(this).addClass('active');
                var foodName = $(this).html();
                $("#j-food-name").html(foodName)
            });
            $(".popup-choose-size li a").click(function(){
                $(this).parent().parent().find('a').removeClass('active');
                $(this).addClass('active');

                var foodSize = $(this).html();
                $("#j-food-size").html(foodSize);
            });
            $("#j-add-cart").click(function(){
                $(this).addClass('hide');
                $(this).siblings(".m-goods-count").removeClass('hide');
            });
            //选择数量 减
            $('.popup-choose').on('click','.icon-btn-reduce', function(){
                reduceNum.call(this,-1);
            })
            //选择数量 加
            $('.popup-choose').on('click', '.icon-btn-add', function(){
                reduceNum.call(this,1);
            });

            function reduceNum(arg) {
                var num =  parseInt($(".count-number").html());
                var count = num + arg;
                if(count <= 0){
                    $(this).parent().addClass('hide');
                    $(this).parent().siblings('a').removeClass('hide');
                } else {
                    $(".count-number").html(count);
                }
            }

            $('body').click(function(){
                $(".popup-overlay").addClass("close-popup")//关闭 我的账本-筛选 弹出层
            });

        });
    </script>
</body>
</html>